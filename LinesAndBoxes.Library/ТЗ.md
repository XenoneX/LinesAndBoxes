# Алгоритм расстановки линий на прямоугольниках
## Дано
1. Есть массив прямоугольников в файле .json. 
Каждый прямоугольник представлен 2-мя точками с координатами, соответственно
это верхний левый и нижний правый углы прямоугольника.
2. Гарантируется, что все прямоугольники строго параллельны друг другу и
не пересекаются, так же они все расположены либо горизонтально,
либо вертикально (либо одна, либо вторая сторона расположена параллельно
основной оси).
3. Длина прямоугольников меряется по оси X, ширина - по оси Y.
4. Ширины прямоугольников могут повторяться. 
5. Не гарантируется, что прямоугольники представляют из себя единую фигуру,
т.е. они могут располагаться сколь угодно далеко друг от друга на плоскости.
6. Есть переменная **L0**, обозначающая максимальное расстояние между отрезками
   (что такое отрезки см. в разделе "Задача"). Гарантированно, что переменная
   больше 0.
7. Есть переменная **L1**, обозначающая максимальное расстояние между отрезком
   и краями прямоугольников. Гарантированно, что переменная больше 0.
8. Есть переменная **L2**, обозначающая минимальную длину прямоугольника
   для расположения на ней двух отрезков.
9. Есть переменная **L3**, обозначающая минимальное расстояние между отрезками.
10. Есть переменная **L4** обозначающая минимальное расстояние между отрезком
    и краем прямоугольника.
11. Гарантированно, что **L0** >= **L1**.
12. Гарантированно, что **L1** > **L2**.
13. Есть переменная **A**, обозначающая угол, на который надо будет поворачивать
    все строящиеся отрезки. Угол отсчитывается от оси Y против часовой стрелки.
    Гарантированно значение угла от -90 до 90 и не равно 90 или -90. 
    По умолчанию 0.
14. Есть переменная **W1**, обозначающая кратность длины получаемой линии.
## Задача
Необходимо расположить отрезки на данных прямоугольниках так, чтобы они удовлетворяли
следующим условиям:
1. Расстояние между двумя отрезками, пересекающие один прямоугольник максимум
   **L0**.
2. Прямоугольник, длиной более **L2** должен пересекаться минимум двумя отрезками.
3. Прямоугольник, длиной менее либо равно **L2** может пересекаться одним отрезком.
4. Расстояние между пересечением отрезка и краями прямоугольника, который он
   пересекает, меньше либо равно **L1**.
5. Отрезок должен быть длиной минимум \[2 * **W1**\] (не обязательный, но
   желательный)
6. Один отрезок должен пересекать минимум два прямоугольника (не обязательный,
   но желательный)
7. Количество пересечений должно быть сведено к минимуму.
8. Общая длина линий должна быть сведена к минимуму.
9. Общее количество отрезков должна быть сведена к минимуму.
## Результат
Алгоритм должен быть оформлен в виде класса, в котором есть метод, который
принимает массив из прямоугольников "как они есть" и параметры,
необходимые для работы алгоритма.
Результатом должен быть массив из линий, где указаны две координаты - начало
и конец.
Для тестов нужно сделать консольную программу (ну или с УИ, как лучше), которая
будет принимать на вход параметр пути до файла json и другие параметры, необходимые
для работы алгоритма. В итоге должен быть сформировано изображение с прямоугольниками
и отрезками, разделенные цветом.
Язык программирования: C#. Фреймворк не ниже .Net 5.0.
## Непосредственно алгоритм
Данный алгоритм не является оптимальным, но может быть одним из решений
(это надо проверить):
1. Проходимся по массиву прямоугольников и расставляем **ПРЕДВАРИТЕЛЬНЫЕ** точки:
   1. Если длина панели меньше **L2**, то ставим предварительную точку
точно по середине панели.
   2. Если длина панели меньше либо равно \[3 * **L1**\], то ставятся две равноудаленные
точки как друг от друга, так и от краев панелей.
   3. Если длина панели больше \[3 * **L1**\], но меньше \[2 * **L1** + **L0**\]
и при этом **L1** != **L0**, то ставятся две точки, отступающие от краев
панели на **L1**.
   4. Если длина панели больше \[2 * **L1** + **L0**\], то ставятся две
точки, отступающие от краев панели на **L1**, и такое количество точек
в центре, чтобы, расстояние между всеми точками не превышало **L0**
2. Далее все точки необходимо кластеризировать так, чтобы:
   1. В каждом кластере оказались точки в которых есть пары, расстояние
между которыми не более **L0**.
   2. Пары точек должны быть представлены точками на соседних прямоугольниках.
   3. Соседним является прямоугольник (точнее их два, верхний и нижний),
который находится наиболее близко по оси Y к прямоугольнику, и хотя бы две
его координаты находятся в области рассматриваемой панели по оси X.
   4. Точки не могут быть представлены в двух кластерах одновременно.
3. Для каждого кластера считается его центр масс и через него проводится
   отрезок под заданным углом **A** так, чтобы он не выходил за пределы прямоугольников,
   на которых стоят точки.
   1. Если  в кластере только 1 точка, то отрезок строится через нее и длина отрезка
      ставится так, чтобы она пересекала прямоугольник, на которой строит.
   2. Если в кластере 2 точки, то линия ставится между ними так, чтобы она пересекала
      панели, на которых они построены.
4. Все точки пересечения отрезков закрепляются.
5. Повторяется алгоритм, но с учетом уже закрепленных точек до тех пор, пока
ни одной новой точки нельзя будет поставить.
6. Проводится проверка условий 5 и 6 и соблюдаются не строго.
7. Условия 7, 8 и 9 в данном варианте решения не проверяется. 
   Если какие-то линии не соответствуют условиям, то они удлиняются
   до необходимого размера.
### Пояснения
Под точками, как предварительными, так и закрепленными понимается точка в середине ширины
прямоугольника.
Точкой пересечения отрезка и прямоугольника так же является точка пересечения "средней"
линии прямоугольника и отрезка.
Отсюда расстояние между краем прямоугольника и отрезком - это расстояние между точкой
пересечения прямоугольника и отрезка, и точкой пересечения "средней" линии прямоугольника
и его края.
Чтобы было более понятно. Представьте, что эти прямоугольники - это доски. А отрезки - 
это бруски, на которые кладутся эти доски. Нужно расположить бруски так, чтобы под человеком
они не сломались.

![Пояснение по размерам](img/2022-04-26 12-25-26.jpg)

Визуально алгоритм:

![1](/img/2022-04-26 12-25-34.jpg)

![2](/img/2022-04-26 12-25-41.jpg)

![3](/img/2022-04-26 12-54-59.jpg)

![4](/img/2022-04-26 12-25-47.jpg)
